# GymBro API 配置示例
# 复制为 .env 后按环境替换占位内容

# 应用基本配置
APP_NAME=GymBro API
APP_DESCRIPTION=GymBro 对话与认证服务
APP_VERSION=0.1.0
DEBUG=false

# CORS 配置
CORS_ALLOW_ORIGINS=*
CORS_ALLOW_METHODS=*
CORS_ALLOW_HEADERS=*
CORS_ALLOW_CREDENTIALS=true

# HTTPS 和主机配置
ALLOWED_HOSTS=*
FORCE_HTTPS=false

# Supabase 配置
SUPABASE_PROJECT_ID=your-project-id
SUPABASE_JWKS_URL=https://your-project-id.supabase.co/.well-known/jwks.json
SUPABASE_ISSUER=https://your-project-id.supabase.co
SUPABASE_AUDIENCE=your-project-id
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key
SUPABASE_CHAT_TABLE=chat_messages

# Supabase 调试（仅在 DEBUG=true 时生效：返回插入行表示以便拿到 row id / 内容摘要）
SUPABASE_RETURN_REPRESENTATION=false

# Supabase 保活配置（防止免费层 7 天无活动后暂停）
SUPABASE_KEEPALIVE_ENABLED=true
SUPABASE_KEEPALIVE_INTERVAL_MINUTES=10

# 匿名用户支持配置
ANON_ENABLED=true

# JWT 配置
JWKS_CACHE_TTL_SECONDS=900
JWT_LEEWAY_SECONDS=30

# JWT 验证硬化配置
JWT_CLOCK_SKEW_SECONDS=120
JWT_MAX_FUTURE_IAT_SECONDS=120
JWT_REQUIRE_NBF=false
JWT_ALLOWED_ALGORITHMS=ES256,RS256,HS256

# HTTP 配置
HTTP_TIMEOUT_SECONDS=10.0
SSE_HEARTBEAT_SECONDS=15.0

# 日志落盘（用于按 request_id 聚合最小交接数据）
LOG_TO_FILE=false
LOG_FILE_PATH=logs/app.log

# AI 服务配置
AI_PROVIDER=openai
AI_MODEL=gpt-4o-mini
AI_API_BASE_URL=https://api.openai.com/v1
AI_API_KEY=your-openai-api-key

# 限流配置
RATE_LIMIT_PER_USER_QPS=10
RATE_LIMIT_PER_USER_DAILY=1000
RATE_LIMIT_PER_IP_QPS=20
RATE_LIMIT_PER_IP_DAILY=2000
RATE_LIMIT_ANONYMOUS_QPS=5
RATE_LIMIT_ANONYMOUS_DAILY=1000
RATE_LIMIT_COOLDOWN_SECONDS=300
RATE_LIMIT_FAILURE_THRESHOLD=10

# SSE 并发控制
SSE_MAX_CONCURRENT_PER_USER=2
SSE_MAX_CONCURRENT_PER_CONVERSATION=1
SSE_MAX_CONCURRENT_PER_ANONYMOUS_USER=2

# 回滚预案配置（紧急情况下快速禁用新功能）
AUTH_FALLBACK_ENABLED=false
RATE_LIMIT_ENABLED=true
POLICY_GATE_ENABLED=true
