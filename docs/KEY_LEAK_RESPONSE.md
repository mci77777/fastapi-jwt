# 密钥泄露应急响应（Key Leak Response）

本页是“发现密钥泄露”时的最小处置清单，目标：**止血 → 复盘 → 防再发**。

## 0) 立即止血（必须）

1. **撤销/轮转密钥**（按供应商控制台执行）
2. **下线/替换已暴露的环境变量**（CI、服务器、开发机）
3. **审计访问与账单**（异常调用、异常费用、异常 IP）

## 1) 仓库处置（按场景选择）

- 仅误提交到未推送分支：删除敏感文件 + 重写提交（本地）即可
- 已推送到远程且被其他人拉取：需要 **清理 Git 历史**（rewrite history），并通知全员重新拉取

> 注意：仅删除文件并不能消除历史泄露；必须重写历史后再推送。

## 2) 通知与协作（最小）

- 通知范围：开发者、运维、负责人（必要时通知安全/法务）
- 说明：泄露时间窗、影响范围、已轮转完成时间点、后续动作

## 3) 复盘与防再发

- 开启/强化：pre-commit（detect-secrets）、CI secrets 扫描、PR 模板检查项
- 文档示例统一脱敏：`<redacted>` / `<opaque>`
- 建议把密钥全部迁移到 **secret store**（不要放在客户端与文档中）

