# System Prompt 迭代测试结果

## 版本汇总

| 版本 | 字符数 | 压缩率 | grok | gemini-pro | minimax | 备注 |
|------|--------|--------|------|------------|---------|------|
| v1.0 baseline | 4627 | - | 4/4 | 2/2 | 1/2 | 基线版本 |
| v2.0 compress | 1891 | 59% | 2/3 | 3/3 | 0/3 | 压缩过度 |
| v3.0 structure | 1902 | 59% | 3/3 | 2/3 | 0/3 | 结构优化 |
| v3.1 enforce | 1402 | 70% | 3/3 | 3/3 | 1/3 | 强化约束 |
| v4.0 unified | 1261 | 73% | 5/5 | 4/5 | 2/5 | 统一版本 |
| **v5.0 production** | **1026** | **78%** | **10/10** | N/A* | N/A | **最终版本** |

*注：gemini-pro/minimax 在 v5.0 测试时出现端点错误（非 prompt 问题）

## 最终版本 v5.0

**字符数**: 1026 bytes（较基线压缩 78%）

### 测试结果 (2026-01-17)

| 模型 | 状态 | 通过率 | 测试规格 | 备注 |
|------|------|--------|----------|------|
| grok | ✅ PASS | 10/10 (100%) | runs=5, turns=2 | grok-4-1-fast-reasoning |

### 关键改进
1. **字符压缩 78%**：4627 → 1026 bytes
2. **结构清晰**：必须输出的完整结构示例前置
3. **规则精简**：去除冗余说明，保留核心约束
4. **强制要求明确**：thinking/phase/title/final 必须存在

---

## 迭代历程

### v1.0 → v2.0
- 目标：去除冗余说明和重复约束
- 结果：压缩 59%，但稳定性下降

### v2.0 → v3.0
- 目标：结构优化，前置核心约束
- 结果：grok 恢复稳定

### v3.0 → v3.1
- 目标：强化关键约束
- 结果：所有可用模型改善

### v3.1 → v4.0
- 目标：统一版本，简化规则
- 结果：grok 100%

### v4.0 → v5.0
- 目标：最终生产版本
- 结果：grok 10/10 (100%)，多轮对话稳定

---

## 端点可用性说明

以下模型因端点问题无法完成 prompt 迭代测试：
- deepseek: 472 错误
- claude-sonnet: 400 错误
- gpt-5.2: 400 错误
- gemini-flash: upstream_empty_content

建议修复端点后重新测试 v5.0 版本。

---

## 文件清单

```
docs/prompt/
├── v1.0_baseline.md      # 基线版本
├── v2.0_compress.md      # 压缩版本
├── v3.0_structure.md     # 结构优化版本
├── v3.1_enforce.md       # 强化约束版本
├── v4.0_unified.md       # 统一版本
├── v5.0_production.md    # 最终生产版本 ✅
├── test_results.md       # 本文档
└── CHANGELOG.md          # 变更日志
```
