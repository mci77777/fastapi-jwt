ID,Title,Description,Acceptance,Test_Method,Tools,Dev_Status,Review1_Status,Regression_Status,Files,Dependencies,Notes
A1,强化 ThinkingML 结构校验器,"把 `docs/ai预期响应结构.md` 的必选规则落到校验函数：标签白名单、phase id 递增、`</thinking>` 后紧跟 `<final>`、`<final>` 末尾 serp_queries 注释块 JSON 合法（≤5）。","结构不合规时能返回稳定 reason；合规 reply 一律通过；遇到非法标签/乱序输出明确失败。","运行逐模型 E2E；（可选）添加几条负例断言校验 reason。","mcp__feedback__codebase-retrieval;functions.exec_command;functions.apply_patch",DONE,TODO,DONE,"scripts/monitoring/local_mock_ai_conversation_e2e.py;tests/*",docs/ai预期响应结构.md,"DONE：`local_mock_ai_conversation_e2e.py` 校验升级为严格契约（serp_queries JSON/phase/title/顺序/白名单）。"
A2,逐 mapped models 进行 E2E 回归,"以 `/api/v1/llm/models?view=mapped` 返回的 `data[].name` 为 SSOT，逐个发起 `POST /api/v1/messages` 并消费 SSE `/events`，拼接 reply 后做结构校验并汇总。","每个 mapped model 都有一条 PASS/FAIL 结果；整体 exit code=0 代表全通过；失败输出 model+request_id+reason。","新增/扩展脚本运行一次即可覆盖全部模型；必要时支持 docker base_url=localhost:9999。","mcp__feedback__codebase-retrieval;functions.exec_command;functions.apply_patch",DONE,TODO,DONE,"scripts/monitoring/*","/api/v1/llm/models; /api/v1/messages; MessageEventBroker","DONE：逐个遍历 mapped models（SSOT），输出 PASS/FAIL 汇总并以 exit code 表达回归结果。"
A3,集成到 pytest 并更新文档,"将逐模型回归（可选）以 pytest 方式接入，并更新 `docs/e2e-ai-conversation/QUICK_START.md` 写明命令与判定标准。","pytest 可运行并在失败时给出清晰断言；文档包含一条命令即可执行逐模型结构回归。","`PYTHONPATH=. .venv/bin/python -m pytest -q tests`（或 `-k mapped_model_structure`）通过；检查文档已更新。","functions.exec_command;functions.apply_patch",DONE,TODO,DONE,"tests/test_mapped_models_thinkingml_structure_e2e.py;docs/e2e-ai-conversation/QUICK_START.md",pytest;.venv,"DONE：pytest 通过 subprocess 运行脚本（隔离 env/SQLite/runtime），并在文档补齐回归入口。"
