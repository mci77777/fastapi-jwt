ID,Title,Description,Acceptance,Test_Method,Tools,Dev_Status,Review1_Status,Regression_Status,Files,Dependencies,Notes
A1,Real E2E runner（xai/deepseek）,新增真实上游的多轮对话 E2E runner：按 mapping 取 model -> /messages -> SSE 拼接 reply -> ThinkingML 结构校验；支持 runs/turns 并输出 request_id 等可对账信息。,1) 新增脚本可跑且不 mock 上游 2) 支持 --models xai deepseek --runs N --turns M 3) 失败产物脱敏且可复现（request_id/endpoint_id/resolved_model/reason）,`.venv/bin/python scripts/monitoring/real_ai_conversation_e2e.py --models xai deepseek --runs 1 --turns 1`,feedback:codebase-retrieval;functions:exec_command;functions:apply_patch,DONE,TODO,DONE,scripts/monitoring/real_ai_conversation_e2e.py;docs/ai预期响应结构.md,已配置 xai/deepseek endpoint+api_key,done_at=2026-01-08T12:30+08:00 e2e=.venv/bin/python scripts/monitoring/real_ai_conversation_e2e.py --models xai deepseek --runs 1 --turns 1 (xai fail phase_block_mismatch deepseek pass)
A2,Prompt 调整：优先稳定 xai,基于真实 E2E 失败样式迭代 `serp_prompt.md`（必要时联动 `tool.md`/`standard_serp_v2.json`），确保 xai 多轮输出严格符合 ThinkingML。,1) xai 在 real E2E 下 runs=10 turns=3 全 PASS 2) 输出仅含白名单标签且顺序正确 3) 失败输出严格为 <<ParsingError>>（无额外字符）,`.venv/bin/python scripts/monitoring/real_ai_conversation_e2e.py --models xai --runs 10 --turns 3`,feedback:codebase-retrieval;functions:exec_command;functions:apply_patch,TODO,TODO,TODO,assets/prompts/serp_prompt.md;assets/prompts/tool.md;assets/prompts/standard_serp_v2.json,已配置 xai endpoint+api_key,只改 assets 作为 prompt SSOT；runner 启动期写入并 activate，避免 DB 影子 prompt
A3,Prompt 调整：再稳定 deepseek,在 xai 稳定后继续迭代同一套 prompt，使 deepseek 多轮输出也严格符合 ThinkingML。,1) deepseek 在 real E2E 下 runs=10 turns=3 全 PASS 2) 不引入额外 XML 标签或尾部文本 3) 失败输出严格为 <<ParsingError>>（无额外字符）,`.venv/bin/python scripts/monitoring/real_ai_conversation_e2e.py --models deepseek --runs 10 --turns 3`,feedback:codebase-retrieval;functions:exec_command;functions:apply_patch,TODO,TODO,TODO,assets/prompts/serp_prompt.md;assets/prompts/tool.md;assets/prompts/standard_serp_v2.json,已配置 deepseek endpoint+api_key,若 deepseek 与 xai 输出约束冲突，优先以契约 SSOT 取交集并保持 KISS
A4,可选稳定参数：mapping 级 temperature=0,若仅靠 prompt 仍无法 100%：为 mapping=xai/deepseek 注入最小稳定参数（优先 temperature=0），不影响其它模型。,1) xai+deepseek 在 real E2E runs=10 turns=3 全 PASS 2) 仅对目标 mapping 生效 3) 仍保持请求体/协议兼容,`.venv/bin/python scripts/monitoring/real_ai_conversation_e2e.py --models xai deepseek --runs 10 --turns 3`,feedback:codebase-retrieval;functions:exec_command;functions:apply_patch,TODO,TODO,TODO,app/services/ai_service.py;app/services/model_mapping_service.py,完成 A2/A3 后仍不稳定时才启用,保持 KISS：不要做复杂重试/解析修复，优先让模型“按契约输出”
A5,文档补齐：real E2E 跑法与验收口径,把真实 E2E 的环境变量、命令、验收口径写入 Quick Start，并说明与 mock E2E 的边界。,1) 文档包含 mock/real 两种 E2E 入口 2) 明确需要配置 mapping+endpoint+key 3) 给出回滚/排障提示,阅读文档按步骤跑通（mock=exit0；real=至少 1 次跑通）,functions:exec_command;functions:apply_patch,TODO,TODO,TODO,docs/e2e-ai-conversation/QUICK_START.md;docs/ai预期响应结构.md,A1 完成后,文档以 docs/ai预期响应结构.md 为 SSOT，不复制大段协议内容
