ID,Title,Description,Acceptance,Test_Method,Tools,Dev_Status,Review1_Status,Regression_Status,Files,Dependencies,Notes
A1,定稿 App 用户 SSOT 视图与字段字典,以 `auth.users` 为全集并与 `public.users`/`public.user_entitlements` 聚合成 `public.app_users_admin_view`（仅 service_role 可读），同时定稿“缺失资料”与匿名字段语义。,"视图存在且可查询；字段覆盖 auth/public/entitlements；匿名/缺失资料语义明确",supabase-mcp-server:execute_sql（to_regclass + sample select）,"supabase-mcp-server:apply_migration;supabase-mcp-server:execute_sql",TODO,TODO,TODO,scripts/deployment/sql/create_supabase_tables.sql;docs/schemas/SUPABASE_SCHEMA_OWNERSHIP_AND_NAMING.md,Supabase service_role;PostgREST schema cache,避免将权限写入两处导致影子状态
A2,封装 Supabase Auth Admin 客户端,新增最小 `SupabaseAuthAdminClient`：list/get/update user（禁用/metadata/密码）并复用统一错误响应（含 hint/request_id）。,能完成 list/get/update/reset-password 并返回统一错误体,pytest 覆盖 + supabase-mcp-server:search_docs 核验 API 边界,"feedback:codebase-retrieval;supabase-mcp-server:search_docs",TODO,TODO,TODO,app/services/*;app/core/exceptions.py,SUPABASE_SERVICE_ROLE_KEY,默认不依赖邮件系统（管理员直改密码）
A3,新增 Admin App 用户管理 API,新增 `/api/v1/admin/app-users/*`：list/detail/entitlements/permissions/disable/reset-password，并写入 `public.audit_logs` 形成可追溯链路。,"端点可用且仅 admin 可访问；写操作均有审计记录；错误响应统一",make test（新增 tests）,"feedback:codebase-retrieval;supabase-mcp-server:execute_sql",TODO,TODO,TODO,app/api/v1/*;tests/*,FastAPI router;鉴权依赖,接口与页面解耦旧 `/api/v1/user/*`
A4,前端新增 App 用户管理页面,新增 `/system/app-users`：列表+详情抽屉（订阅/权限/禁用/重置密码），默认不拉匿名但展示匿名数量；危险操作二次确认。,"页面可用；默认策略符合预期；操作成功/失败提示可诊断",e2e 冒烟（浏览器/Network）+ API mock 测试,"feedback:codebase-retrieval",TODO,TODO,TODO,web/src/views/system/*;web/src/api/*,Naive UI;现有鉴权拦截器,保持 UI 最小：不重做旧“用户管理”页
A5,用户管理配置项（Dashboard 本地 SSOT）,增加可配置项并持久化到 SQLite：默认分页/排序/过滤/危险操作开关/二次确认策略；前端读取后驱动默认行为。,"配置重启不丢；默认行为可由配置控制；非法配置被拒绝",pytest + 手工验证配置生效,"feedback:codebase-retrieval",TODO,TODO,TODO,app/db/sqlite_manager.py;app/api/v1/*;web/src/views/system/*,SQLite;现有配置模式,仅存 Dashboard 配置，不污染 Supabase
A6,校验脚本与回归,增强 `scripts/verification/verify_supabase_config.py`：校验 `app_users_admin_view`、必要表与关键字段可访问，作为部署前探针。,"脚本 PASS/FAIL 可定位缺失项；输出修复建议",.venv/bin/python scripts/verification/verify_supabase_config.py,"supabase-mcp-server:execute_sql",TODO,TODO,TODO,scripts/verification/verify_supabase_config.py,SUPABASE_* env,部署前必跑
