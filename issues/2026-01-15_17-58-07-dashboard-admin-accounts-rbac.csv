ID,Title,Description,Acceptance,Test_Method,Tools,Dev_Status,Review1_Status,Regression_Status,Files,Dependencies,Notes
A1,扩展 local_users 作为账号 SSOT,为 SQLite `local_users` 增列 role/is_active/last_login_at 并补齐兼容逻辑；复用现有 scrypt 哈希实现,老库升级后可读写；不破坏现有 admin 登录与改密；禁止出现影子状态,`make test`,feedback:codebase-retrieval;Bash,TODO,TODO,TODO,app/db/sqlite_manager.py;app/api/v1/base.py,依赖现有 SQLite 初始化脚本,默认 seed admin/123456 不变
A2,后台账号管理 Admin API,新增 `/api/v1/admin/dashboard-users/*`（list/create/role/enable-disable/reset-password）仅 super_admin 可用并保护至少一个 active super_admin,接口返回结构稳定；越权 403；危险操作需二次确认字段（用户名）且返回 request_id,`make test`；手动 `curl` 验证越权与重置密码,feedback:codebase-retrieval;Bash,TODO,TODO,TODO,app/api/v1/admin_dashboard_users.py;app/api/v1/base.py,依赖 A1 的 local_users 扩展,重置密码仅响应一次明文并提示复制
A3,登录与权限返回改造,让 `/base/access_token` 支持任意本地账号；`/base/userinfo/usermenu/userapi` 基于 role 输出；新增统一鉴权依赖并用于关键写接口,次级角色菜单与 api 列表正确；直接调用未授权写接口同样 403,`make test` 覆盖登录与越权路径,feedback:codebase-retrieval;Bash,TODO,TODO,TODO,app/api/v1/base.py;app/api/v1/llm_common.py;app/api/v1/admin_app_users.py,依赖 SSOT 的 role->api 映射,避免与 is_dashboard_admin_user 的旧逻辑冲突
A4,前端后台账号管理页,新增“后台账号”页面并接入新增 API；按钮用 `v-permission`；危险操作统一二次确认并支持复制重置密码,页面交互闭环可用；无权限账号不展示入口且按钮权限生效,`cd web && pnpm build`；手动浏览器验证,feedback:codebase-retrieval;Bash,TODO,TODO,TODO,web/src/views/system/admin-accounts/index.vue;web/src/api/index.js;app/api/v1/base.py,依赖 A2 的接口与 /base/usermenu 返回,沿用现有 Naive UI 与权限指令
A5,测试与回滚说明,补齐 pytest 覆盖创建账号登录越权重置密码等关键路径并记录回滚步骤,`make test` 通过且无新增不稳定用例；回滚路径清晰可执行,`make test`；`git diff` 仅聚焦本需求,feedback:codebase-retrieval;Bash,TODO,TODO,TODO,tests/test_dashboard_local_accounts.py;plan/2026-01-15_17-58-07-dashboard-admin-accounts-rbac.md,依赖现有 pytest 与本地 SQLite 测试夹具,避免写入真实密钥与敏感数据
