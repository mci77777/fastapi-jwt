ID,Title,Description,Acceptance,Test_Method,Tools,Dev_Status,Review1_Status,Regression_Status,Files,Dependencies,Notes
C1,"后端：blocked models SSOT + resolve 强制生效","在 `ModelMappingService` 增加 blocked models 存储（带锁），并在 `resolve_for_message`/解析链路中跳过被屏蔽模型（默认被屏蔽则回退候选；全被屏蔽则明确失败）。","屏蔽后不会被选中为 resolved_model；存在可用候选时可回退；全被屏蔽时返回可定位错误/原因。","新增/调整 pytest 覆盖：屏蔽默认模型后回退；屏蔽全部后失败。","feedback:codebase-retrieval;functions:exec_command;functions:apply_patch",TODO,TODO,TODO,"app/services/model_mapping_service.py","AIConfigService","保持 SSOT 单一路径：禁止只在前端过滤。"
C2,"后端：blocked models 管理 API（admin-only 写）","新增 blocked models list/upsert API；写操作仅 admin 可用（统一收敛到 `require_llm_admin`/dashboard admin 判定），并返回当前 blocked 集合供前端展示。","非 admin 调用写接口 403；admin 可批量屏蔽/解除屏蔽并持久化。","pytest：非 admin 403；admin 200；再次 GET 能读到最新状态。","feedback:codebase-retrieval;functions:exec_command;functions:apply_patch",TODO,TODO,TODO,"app/api/v1/llm_models.py;app/api/v1/llm_common.py","C1","权限模型需与 dashboard admin JWT 兼容。"
C3,"后端：App models 观测增强（admin debug）","扩展 `/api/v1/llm/app/models`：允许 admin 在非 DEBUG 环境也获取 debug 字段（resolved_model/candidates/source 等），且 debug 输出体现 blocked 后结果；普通用户保持原输出。","admin 可观测映射→resolved_model；debug 输出与屏蔽结果一致；非 admin 不泄露 debug 字段。","pytest：admin debug=1 返回包含 debug 字段；非 admin debug=1 不返回/不包含。","feedback:codebase-retrieval;functions:exec_command;functions:apply_patch",TODO,TODO,TODO,"app/api/v1/llm_models.py;app/api/v1/llm_common.py","C1;C2","避免依赖 settings.DEBUG；以 admin 判定为门禁。"
C4,"前端：Dashboard 新增“供应商模型屏蔽”面板","在 Dashboard 内展示按 endpoint 聚合的 model_list（实际拉取到的 models），并提供屏蔽/解除屏蔽开关；展示 provider/base_url/status/latency 等健康观测点。","Dashboard 可看到模型→供应商→health；可一键屏蔽并立即反映到观测数据。","`cd web && npm run build`；admin 登录 Dashboard 冒烟：切换屏蔽开关成功且提示明确。","feedback:codebase-retrieval;functions:exec_command;functions:apply_patch",TODO,TODO,TODO,"web/src/views/dashboard/index.vue;web/src/components/dashboard/*;web/src/api/*","C2","写操作需用 `v-permission` 控制按钮/开关。"
C5,"前端：Dashboard 映射→实际→供应商→health 观测联动","Dashboard 内联动展示：映射列表（复用 `ModelMappingCard`）+ App models 列表（调用 `/llm/app/models`）+ resolved_model 命中供应商与 health 状态（来自 endpoints 列表/或 admin debug 字段）。","一屏可追踪：映射模型→resolved_model→命中 endpoint→status；屏蔽后链路变化可观测。","admin 登录 Dashboard 冒烟；必要时补充轻量前端单元/快照（如项目已有）。","feedback:codebase-retrieval;functions:exec_command;functions:apply_patch",TODO,TODO,TODO,"web/src/views/dashboard/index.vue;web/src/components/dashboard/*;web/src/api/*","C3;C4","优先复用现有 store/组件，避免再造一套模型状态。"
