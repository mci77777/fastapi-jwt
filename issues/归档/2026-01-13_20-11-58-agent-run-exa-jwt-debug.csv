ID,Title,Description,Acceptance,Test_Method,Tools,Dev_Status,Review1_Status,Regression_Status,Files,Dependencies,Notes
B1,Agent Prompt/Tools SSOT 对齐,补齐/校验 agent_system+agent_tools 的 SSOT：Dashboard 可管理；active-agent-prompts 快照可用于 JWT 页对账（含 tools schema 关键信息）。,JWT 页能展示 agent 的 effective system message，且 tools schema 中包含 `web_search.exa` 与 `gymbro.exercise.search`（或至少可从 tools_prompt.tools_json 读取）。,手动：调用 `/api/v1/llm/tests/active-agent-prompts` 并对照 Dashboard Prompt 管理页；确保切换 active 后快照变化一致。,functions:shell_command;functions:apply_patch;feedback:codebase-retrieval;functions:mcp__context7__get-library-docs,TODO,TODO,TODO,app/api/v1/llm_tests.py;app/services/ai_service.py;app/services/ai_config_service.py;assets/prompts/agent_tool.md,Prompt 管理页已支持 agent_* 类型,优先不改协议；仅增强对账字段与文档解释。
B2,JWT 调试页：Agent/Message 对账与注入,让 JWT SSE 调试页默认走“Dashboard server prompt（SSOT）+ 推荐 result_mode”，并在 Agent/Messages 两个 tab 下都能一键“填充 Dashboard 有效 system message”；同时增加 tool_choice 风险提示（避免误触发上游 tool_calls）。,同一组 Dashboard 配置下：server 模式与“填充 Dashboard prompt 的 passthrough”表现一致；推荐配置下 completed 自动校验 ThinkingML v4.5 通过。,“手测”浏览器：获取 JWT→选择模型→Messages/Agent 各跑一次→观察 tool 事件与 ThinkingML 校验；切换 tab 不丢 token。,functions:apply_patch;functions:shell_command,TODO,TODO,TODO,web/src/views/ai/model-suite/jwt/RealUserSseSsot.vue;web/src/store/modules/aiModelSuite.js;web/src/api/aiModelSuite.js,active prompts/agent prompts 快照接口,UI 只做护栏与对账；不引入 WebSocket。
B3,Exa 配置链路（Dashboard→Agent Run）稳定化,确保 Exa Key 与开关以 Dashboard 写入为 SSOT（`llm_app_settings`），Agent Run 在启用时稳定执行 `web_search.exa` 并通过 SSE 输出 `tool_start/tool_result`（含 elapsed_ms 与 error.code）。,配置 key 并开启后：SSE 中 `web_search.exa` tool_result ok=true；未配置 key：ok=false 且 error.code=missing_api_key；匿名 JWT 也可调用 `/agent/runs`。,“手测”+ curl：按文档设置 Dashboard 配置后跑一次 `/agent/runs` 并订阅 SSE；观察 tool 事件与 completed。,functions:apply_patch;functions:shell_command,TODO,TODO,TODO,app/api/v1/agent_runs.py;app/services/web_search_service.py;app/api/v1/llm_models.py,Dashboard 已有 `/llm/app/config` 管理入口,请求侧仅允许关闭 web_search（控成本）；如需强制开启仅限 admin/测试场景再评估。
B4,文档 + Docker 重启部署,补齐/更新 `./docs`：Agent Run（/agent）契约、Exa 配置、JWT 调试页推荐流程、常见 ThinkingML 失败原因与排查；并重启 docker 验证健康。,“按 docs 步骤”可复现：配置 Exa→JWT 页跑通→ThinkingML 校验 PASS；docker 重启后 `/api/v1/healthz`=200。,docker：`docker compose up -d --build`；健康：`curl http://localhost:9999/api/v1/healthz`；手测 JWT 页。,functions:apply_patch;functions:shell_command,TODO,TODO,TODO,docs/AGENT_RUN_DEBUG_WEB.md;docs/api-contracts/api_gymbro_cloud_agent_run_min_contract.md;docker-compose.yml,已有基础契约文档与 SSE 调试文档,如发现 UI/后端字段漂移，先修 SSOT 再补文档。
